<%- include('_header', { title: 'Admin: Kelola Produk' }) %>

<div class="d-flex justify-content-between align-items-center mb-4 reveal-on-scroll">
    <h1>Kelola Produk</h1>
    <a href="/admin/products/new" class="btn btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3z"/>
        </svg>
        Tambah Produk Baru
    </a>
</div>

<div class="card reveal-on-scroll">
    <div class="table-responsive">
        <table class="table table-striped table-hover mb-0 align-middle">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Nama Produk</th>
                    <th>Harga</th>
                    <th>Stok</th>
                    <th>Status</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody>
                <% products.forEach(product => { %>
                    <tr class="<%= (product.is_archived) ? 'table-secondary text-muted' : '' %>">
                        <td><%= product.id %></td>
                        <td>
                            <%= product.name %>
                            <% if (product.is_archived) { %>
                                <span class="badge bg-danger ms-2">Diarsip</span>
                            <% } %>
                        </td>
                        <td>Rp <%= Number(product.price).toLocaleString('id-ID') %></td>
                        <td><%= product.stock_quantity %></td>
                        <td>
                            <% if (product.is_archived) { %>
                                <span class="badge bg-danger">Diarsip</span>
                            <% } else if (product.stock_quantity > 0) { %>
                                <span class="badge bg-success">Aktif</span>
                            <% } else { %>
                                <span class="badge bg-warning">Stok Habis</span>
                            <% } %>
                        </td>
                        <td>
                            <% if (product.is_archived) { %>
                                <form action="/admin/products/restore/<%= product.id %>" method="POST" class="d-inline">
                                    <button type="submit" class="btn btn-success btn-sm">Pulihkan</button>
                                </form>
                            <% } else { %>
                                <a href="/admin/products/edit/<%= product.id %>" class="btn btn-warning btn-sm">Edit</a>
                                <form action="/admin/products/delete/<%= product.id %>" method="POST" class="d-inline ms-1">
                                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Yakin ingin meng-arsip produk ini?')">Arsip</button>
                                </form>
                            <% } %>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
</div>

<%- include('_footer') %>